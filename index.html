<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Oluştur - Hedef Temelli Destek Eğitimi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body class="pdf-export">
    <div id="pdf-root"></div>
    <script src="qrious.min.js"></script>
    <!-- PDF dışa aktarma kütüphaneleri: html2canvas DOM -> canvas, jsPDF PDF oluşturma için -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- PDF Preview Plugin -->
    <script src="script.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // PDF Eklentisini yapılandırma ile başlat

            const response = await fetch('example.json');
            // ÖNEMLİ Verileri JSON olarak al ve bu değişkene ata, veri örneği: example.json
            const data = await response.json(); 
            
            let preview = PDFPreview.init({
                container: '#pdf-root',
                data: data,
                toolbar: {
                    enabled: true,
                    showBack: true,
                    showEdit: true,
                    showHomework: true,
                    showDownload: true,
                    title: 'PDF Oluştur'
                },
                export: {
                    filename: 'hedef-temelli-destek-egitimi.pdf',
                    message: 'PDF hazırlanıyor, lütfen bekleyin...'
                },
                modal: {
                    openOnFirstLoad: false,
                },
                // Event callbacks
                onBack: function() {
                    console.log('Geri butonu tıklandı');
                    // Geri navigasyon mantığınızı buraya ekleyin
                    // window.history.back();
                },
                onHomework: function(data) {
                    console.log('Ödev gönder butonu tıklandı', data);
                    // Ödev gönderme mantığınızı buraya ekleyin
                    // Örnek: veriyi sunucuya gönder
                    // fetch('/api/homework', { method: 'POST', body: JSON.stringify(data) });
                },
                onDataSaved: function(newData, oldData) {
                    console.log('Yeni veri kaydedildi!', newData);
                    console.log('Eski veri:', oldData);
                    
                    // You can handle specific changes here
                    if (oldData.lessonName !== newData.lessonName) {
                        console.log('Ders Adı değişti:', newData.lessonName);
                    }
                    
                    if (oldData.testType !== newData.testType) {
                        console.log('Test Türü değişti:', newData.testType);
                    }
                },
                onError: function(message, error) {
                    console.error('PDF Preview Error:', message, error);
                    // Hataları düzgün bir şekilde ele al
                }
            });

            // init sonrası kullanılabilir fonksiyonlar:
            //preview.download();
            //preview.openEdit();
            //preview.send();

        });
    </script>
</body>
</html>